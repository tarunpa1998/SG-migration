(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[720],{93098:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var a=t(95155),i=t(12115),l=t(35695),r=t(52338),n=t(78496),c=t(492),d=t(25930),o=t(14236),h=t(75234),m=t(16784),x=t(9436),u=t(28452),j=t(87027),p=t(84616),g=t(47924),w=t(57434),y=t(14541),N=t(51154),v=t(89917),f=t(62525),C=t(90424);let k={title:"",content:"",summary:"",slug:"",publishDate:new Date().toISOString(),author:"",authorTitle:"",authorImage:"",image:"",category:"",isFeatured:!1,seo:{metaTitle:"",metaDescription:"",keywords:[]},views:0},b=()=>{let[e,s]=(0,i.useState)([]),[t,l]=(0,i.useState)(!0),[b,A]=(0,i.useState)(""),[F,S]=(0,i.useState)(null),[E,T]=(0,i.useState)(!1),[D,I]=(0,i.useState)(!1),[J,L]=(0,i.useState)("list"),[_,U]=(0,i.useState)(k),[q,O]=(0,i.useState)(!1),[$,z]=(0,i.useState)("basic"),{toast:B}=(0,x.d)();(0,i.useEffect)(()=>{R()},[]);let R=async()=>{l(!0);try{if(!localStorage.getItem("adminToken"))throw Error("Authentication required");let e=await fetch("/api/news");if(!e.ok)throw Error("Failed to fetch news");let t=await e.json();s(t)}catch(e){console.error("Error fetching news:",e),B({title:"Error fetching news",description:e instanceof Error?e.message:"Unknown error occurred",variant:"destructive"})}finally{l(!1)}},M=e=>{T(!0),U(e),S(e),I(!0),z("basic")},P=async t=>{if(confirm("Are you sure you want to delete this news item?"))try{let a=localStorage.getItem("adminToken");if(!a)throw Error("Authentication required");if(!(await fetch("/api/admin/news/".concat(t),{method:"DELETE",headers:{"x-auth-token":a}})).ok)throw Error("Failed to delete news");s(e.filter(e=>e._id!==t&&e.id!==t)),B({title:"News deleted",description:"The news item has been deleted successfully",variant:"default"})}catch(e){console.error("Error deleting news:",e),B({title:"Error deleting news",description:e instanceof Error?e.message:"Unknown error occurred",variant:"destructive"})}},X=async()=>{O(!0);try{let t=localStorage.getItem("adminToken");if(!t)throw Error("Authentication required");if(!_.title||!_.content||!_.summary)throw Error("Title, content, and summary are required");let a={..._,seo:{..._.seo,keywords:"string"==typeof _.seo.keywords?String(_.seo.keywords).split(",").map(e=>e.trim()).filter(Boolean):_.seo.keywords}},i=(null==F?void 0:F.id)||(null==F?void 0:F._id),l=await fetch(E?"/api/admin/news/".concat(i):"/api/admin/news",{method:E?"PUT":"POST",headers:{"Content-Type":"application/json","x-auth-token":t},body:JSON.stringify(a)});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to save news")}let r=await l.json();E?s(e.map(e=>e.id===r.id||e._id===r._id?r:e)):s([...e,r]),I(!1),B({title:E?"News updated":"News created",description:E?"The news has been updated successfully":"A new news item has been created successfully",variant:"default"})}catch(e){console.error("Error saving news:",e),B({title:"Error saving news",description:e instanceof Error?e.message:"Unknown error occurred",variant:"destructive"})}finally{O(!1)}},H=e=>{let{name:s,value:t}=e.target;if(s.includes(".")){let[e,a]=s.split(".");"seo"===e?U({..._,seo:{..._.seo,[a]:t}}):U({..._,[e]:{..."object"==typeof _[e]&&null!==_[e]?_[e]:{},[a]:t}})}else U({..._,[s]:t})},Z=(e,s)=>{U({..._,[e]:s})},W=e.filter(e=>e.title.toLowerCase().includes(b.toLowerCase())||e.summary.toLowerCase().includes(b.toLowerCase())||e.category.toLowerCase().includes(b.toLowerCase()));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"News"}),(0,a.jsx)("p",{className:"text-slate-500 mt-2",children:"Manage all your news items"})]}),(0,a.jsxs)(n.$,{onClick:()=>{T(!1),U(k),S(null),I(!0),z("basic")},children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Create News Item"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative w-full max-w-sm",children:[(0,a.jsx)(g.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-500"}),(0,a.jsx)(c.p,{type:"search",placeholder:"Search news...",className:"pl-8",value:b,onChange:e=>A(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(n.$,{variant:"list"===J?"secondary":"ghost",size:"icon",onClick:()=>L("list"),children:(0,a.jsx)(w.A,{className:"h-4 w-4"})}),(0,a.jsx)(n.$,{variant:"grid"===J?"secondary":"ghost",size:"icon",onClick:()=>L("grid"),children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})]}),t?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(N.A,{className:"h-10 w-10 animate-spin text-primary-500"})}):(0,a.jsx)(a.Fragment,{children:"list"===J?(0,a.jsx)(r.Zp,{children:(0,a.jsx)(r.Wu,{className:"p-0",children:(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"Title"}),(0,a.jsx)(o.nd,{children:"Author"}),(0,a.jsx)(o.nd,{children:"Category"}),(0,a.jsx)(o.nd,{children:"Published"}),(0,a.jsx)(o.nd,{children:"Featured"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:0===W.length?(0,a.jsx)(o.Hj,{children:(0,a.jsx)(o.nA,{colSpan:6,className:"text-center text-slate-500 py-10",children:"No news items found"})}):W.map(e=>(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{className:"font-medium",children:e.title}),(0,a.jsx)(o.nA,{children:e.author}),(0,a.jsx)(o.nA,{children:e.category}),(0,a.jsx)(o.nA,{children:new Date(e.publishDate).toLocaleDateString()}),(0,a.jsx)(o.nA,{children:e.isFeatured?(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800",children:"Yes"}):(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-800",children:"No"})}),(0,a.jsx)(o.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>M(e),children:(0,a.jsx)(v.A,{className:"h-4 w-4"})}),(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>P(e.id||e._id||""),children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})]})})]},e.id||e._id))})]})})}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:0===W.length?(0,a.jsx)("div",{className:"col-span-full text-center text-slate-500 py-10",children:"No news items found"}):W.map(e=>(0,a.jsxs)(r.Zp,{children:[(0,a.jsxs)(r.aR,{className:"pb-2",children:[(0,a.jsx)(r.ZB,{className:"text-lg text-ellipsis overflow-hidden whitespace-nowrap",title:e.title,children:e.title}),(0,a.jsxs)(r.BT,{className:"flex justify-between",children:[(0,a.jsx)("span",{children:e.author}),(0,a.jsx)("span",{children:new Date(e.publishDate).toLocaleDateString()})]})]}),(0,a.jsx)(r.Wu,{className:"pb-2",children:(0,a.jsx)("p",{className:"text-sm text-slate-500 line-clamp-2",children:e.summary})}),(0,a.jsxs)(r.wL,{className:"justify-between",children:[(0,a.jsx)("div",{children:e.isFeatured&&(0,a.jsx)("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800",children:"Featured"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>M(e),children:(0,a.jsx)(v.A,{className:"h-4 w-4"})}),(0,a.jsx)(n.$,{variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-700",onClick:()=>P(e.id||e._id||""),children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})]})]})]},e.id||e._id))})}),(0,a.jsx)(m.lG,{open:D,onOpenChange:I,children:(0,a.jsxs)(m.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(m.c7,{children:[(0,a.jsx)(m.L3,{children:E?"Edit News":"Create New News Item"}),(0,a.jsx)(m.rr,{children:E?"Make changes to the news item":"Add a new news item to your collection"})]}),(0,a.jsxs)(u.tU,{value:$,onValueChange:z,children:[(0,a.jsxs)(u.j7,{className:"grid grid-cols-3 mb-6",children:[(0,a.jsx)(u.Xi,{value:"basic",children:"Basic Info"}),(0,a.jsx)(u.Xi,{value:"content",children:"Content"}),(0,a.jsx)(u.Xi,{value:"seo",children:"SEO & Metadata"})]}),(0,a.jsx)(u.av,{value:"basic",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"title",children:"Title *"}),(0,a.jsx)(c.p,{id:"title",name:"title",value:_.title,onChange:H,placeholder:"News title",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"category",children:"Category *"}),(0,a.jsx)(c.p,{id:"category",name:"category",value:_.category,onChange:H,placeholder:"News category",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"publishDate",children:"Publish Date"}),(0,a.jsx)(c.p,{id:"publishDate",name:"publishDate",type:"date",value:_.publishDate.split("T")[0],onChange:H})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"image",children:"Featured Image URL"}),(0,a.jsx)(c.p,{id:"image",name:"image",value:_.image,onChange:H,placeholder:"https://example.com/image.jpg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"summary",children:"Summary *"}),(0,a.jsx)(h.T,{id:"summary",name:"summary",value:_.summary,onChange:H,placeholder:"Brief overview of the news",required:!0,rows:3})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"author",children:"Author *"}),(0,a.jsx)(c.p,{id:"author",name:"author",value:_.author,onChange:H,placeholder:"Author name",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"authorTitle",children:"Author Title"}),(0,a.jsx)(c.p,{id:"authorTitle",name:"authorTitle",value:_.authorTitle,onChange:H,placeholder:"e.g. Senior Editor"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"authorImage",children:"Author Image URL"}),(0,a.jsx)(c.p,{id:"authorImage",name:"authorImage",value:_.authorImage,onChange:H,placeholder:"https://example.com/author.jpg"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.S,{id:"isFeatured",checked:_.isFeatured,onCheckedChange:e=>Z("isFeatured",e)}),(0,a.jsx)(d.J,{htmlFor:"isFeatured",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Feature this news item (will be displayed prominently)"})]})]})}),(0,a.jsx)(u.av,{value:"content",className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"content",children:"Content *"}),(0,a.jsx)(C.A,{content:_.content,onChange:e=>{U({..._,content:e})},placeholder:"Start writing your news content...",className:"min-h-[400px]"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Supports rich text formatting and markdown"})]})}),(0,a.jsxs)(u.av,{value:"seo",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"seo.metaTitle",children:"Meta Title"}),(0,a.jsx)(c.p,{id:"seo.metaTitle",name:"seo.metaTitle",value:_.seo.metaTitle,onChange:H,placeholder:"SEO title (if different from news title)"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"If left empty, the news title will be used"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"seo.metaDescription",children:"Meta Description"}),(0,a.jsx)(h.T,{id:"seo.metaDescription",name:"seo.metaDescription",value:_.seo.metaDescription,onChange:H,placeholder:"SEO description",rows:3}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"If left empty, the news summary will be used"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"seo.keywords",children:"Keywords"}),(0,a.jsx)(c.p,{id:"seo.keywords",name:"seo.keywords",value:Array.isArray(_.seo.keywords)?_.seo.keywords.join(", "):_.seo.keywords,onChange:H,placeholder:"keyword1, keyword2, keyword3"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Comma-separated list of keywords"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"slug",children:"URL Slug *"}),(0,a.jsx)(c.p,{id:"slug",name:"slug",value:_.slug,onChange:H,placeholder:"news-url-slug",required:!0}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"The slug will be used in the news URL (e.g., /news/news-url-slug)"})]})]})]}),(0,a.jsxs)(m.Es,{children:[(0,a.jsx)(n.$,{variant:"outline",onClick:()=>I(!1),disabled:q,children:"Cancel"}),(0,a.jsx)(n.$,{onClick:X,disabled:q,children:q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4 animate-spin"}),E?"Updating...":"Creating..."]}):E?"Update News":"Create News"})]})]})})]})};function A(){return(0,l.useRouter)(),(0,a.jsx)("div",{className:"container mx-auto py-10",children:(0,a.jsx)(b,{})})}},97509:(e,s,t)=>{Promise.resolve().then(t.bind(t,93098))}},e=>{var s=s=>e(e.s=s);e.O(0,[5004,277,4277,1615,2898,2208,1071,9613,6521,2356,8441,1684,7358],()=>s(97509)),_N_E=e.O()}]);